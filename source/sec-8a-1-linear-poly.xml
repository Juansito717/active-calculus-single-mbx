<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2019                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-8a-1-linear-poly">
  <title>From Linear to Polynomial Approximation: the case of <m>f(x) = e^x</m></title>
  <objectives>
    <ul>
      <li>
        <p>
          How well does the tangent line at <m>a = 0</m> approximate the function <m>f(x) = e^x</m> near <m>a = 0</m>?
        </p>
      </li>
      <li>
        <p>
          Can we find higher degree polynomials that approximate <m>f(x) = e^x</m> near <m>a = 0</m> more effectively than the approximation generated by the tangent line?
        </p>
      </li>
      <li>
        <p>
          How does the degree of the polynomial impact the accuracy of the approximation of <m>f(x) = e^x</m>?
        </p>
      </li>
    </ul>

  </objectives>

  <introduction>
    <p>
      Early in our study of calculus in <xref ref="sec-1-8-tan-line-approx">Section</xref>, we learned that if a function <m>f</m> has a derivative at a fixed value <m>x=a</m>, when we zoom in on its graph near <m>(a,f(a))</m>, the function looks linear.  Indeed, such a function is differentiable, and we know that near a fixed input value <m>a</m>, 
      <me>
        f(x) \approx L(x) = f(a) + f’(a)(x-a),
      </me>
      where <m>L</m> is the tangent line approximation to <m>f</m> at <m>a</m>.

    </p>

    <figure xml:id="F-8a-1-Intro">
      <caption>The function <m>f(x)=e^x</m> and its tangent line <m>L(x)=1+x</m> near the point <m>(0,f(0))</m>.</caption>
      <image width="75%" source="images/8a_1_intro2" />
    </figure>

    <p>
      At right in <xref ref="F-8a-1-Intro">Figure</xref>, we see that near the point of tangency, the approximation of <m>f(x) = e^x</m> by its tangent line is quite good; at the same time, the tangent line and the function itself only agree exactly at the point of tangency, and as we see at left, we need not go far away from the point of tangency to have the difference between <m>f</m> and <m>L</m> be substantial.  
    </p>

    <p>
      It is natural to ask:  can we find a simple function that approximates <m>f</m> more closely than <m>L</m> does and for more values of <m>x</m> near <m>a = 0</m>?
    </p>

    <xi:include href="./previews/PA-8a-1.xml" />
   
  </introduction>

  <subsection>
    <title>Finding a quadratic approximation</title>
    <!-- <idx><h>quadratic approximation</h></idx> -->
    <!-- think carefully about indexing -->

    <p>
      In <xref ref="PA-8a-1">Preview Activity</xref>, we found that a certain quadratic function can produce a better approximation to a given function <m>f</m> near a fixed point of interest.  This idea is a natural generalization of the tangent line approximation.  Next, we seek to understand how to find this well-chosen quadratic.
    </p>

    <p>
      We know that for any function <m>f</m> that has a derivative at <m>a=0</m>, its tangent line approximation at <m>a=0</m> is 
      <me>
        L(x) = f(0) + f’(0)(x - 0)
      </me>
      Moreover, the functions <m>L</m> and <m>f</m> have two exact values in common.  First, their function values agree at the point of tangency: <m>L(0) = f(0)</m>.  And second, since <m>L(x)</m> is a linear function whose slope is <m>f’(0)</m>, it is also true that their derivative values agree at the point of tangency: <m>L’(0) = f’(0)</m>.
    </p>

    <p>
      To generate a quadratic function that approximates <m>f</m> near <m>a = 0</m>, we choose to have this quadratic function not only share the same function value and derivative value as <m>f</m> at <m>a=0</m>, but also (in order to match the concavity) the same second<fn>Here we are implicitly assuming that the function <m>f(x)</m> has a second derivative at <m>a=0</m>.</fn> derivative value at <m>a=0</m>.  
    </p>

    <p>
      We can state these requirements more formally as follows:  we seek a function <m>Q(x)</m> of the form
      <me>
        Q(x) = c_0 + c_1 x + c_2 x^2
      </me>
      that satisfies 
      <ul>
        <li>
          <p>
            <m>Q(0) = f(0)</m>, so <m>Q</m> and <m>f</m> share the same function value at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>Q'(0) = f'(0)</m>, so <m>Q</m> and <m>f</m> share the same first derivative value at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>Q''(0) = f''(0)</m>, so <m>Q</m> and <m>f</m> share the same second derivative value at <m>a = 0</m>.
          </p>
        </li>
      </ul>
    </p>

    <p>
      In <xref ref="act-8a-1-1">Activity</xref>, we explore how these three requirements determine <m>c_0</m>, <m>c_1</m>, and <m>c_2</m> in <m>Q(x)</m> for the function <m>f(x) = e^x</m>.
    </p>

    <xi:include href="./activities/act-8a-1-1.xml" />

    <p>
      While we will develop this idea more formally in <xref ref="sec-8a-2-taylor-poly">Section</xref>, the polynomial <m>Q(x)</m> that we found in <xref ref="act-8a-1-1">Activity</xref> is called the <q>degree 2 <xref ref="def-Taylor-poly-0">Taylor polynomial</xref> of <m>f</m> centered at <m>a=0</m></q>.
    </p>

  </subsection>

  <subsection>
    <title>Over and over again</title>

    <p>
      A remarkable feature of mathematics is that when a process effectively generates an approximation, doing that same process again (perhaps with some slight modifications) often improves the approximation.  In <xref ref="act-8a-1-1">Activity</xref>, we found a quadratic approximation of <m>f(x)=e^x</m> near the point <m>(0,f(0))</m> that results in an improvement over the linear approximation of <m>f</m>.  It is reasonable to hope that a degree 3 polynomial approximation of <m>f(x) = e^x</m> will be even better.
    </p>

    <p>
      To investigate, we seek a degree <m>3</m> polynomial <m>T(x)</m> of the form
      <me>
        T(x) = k_0 + k_1 x + k_2 x^2 + k_3 x^3
      </me>
      that satisfies 
      <ul>
        <li>
          <p>
            <m>T(0) = f(0)</m>, so <m>T</m> and <m>f</m> share the same function value at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>T'(0) = f'(0)</m>, so <m>T</m> and <m>f</m> share the same first derivative value at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>T''(0) = f''(0)</m>, so <m>T</m> and <m>f</m> share the same second derivative value at <m>a = 0</m>.
          </p>
        </li>
        <li>
          <p>
            <m>T'''(0) = f'''(0)</m>, so <m>T</m> and <m>f</m> share the same third<fn>Here we are assuming that the original function <m>f</m> has a third derivative at <m>a = 0</m>.</fn> derivative value at <m>a = 0</m>.
          </p>
        </li>
      </ul>
    </p>

    <p>
      We also observe that since <m>T</m> is a polynomial, its derivatives are straightforward to compute.  For instance, 
        <me>T'(x) = k_1 + 2k_2 x + 3k_3 x^2.</me>
      We continue our investigation of this new approximation of <m>f(x) = e^x</m> in <xref ref="act-8a-1-2">Activity</xref>, where we work to determine the values of <m>k_0</m>, <m>k_1</m>, <m>k_2</m>, and <m>k_3</m> plus explore how well <m>T(x)</m> approximates <m>f(x)</m> near <m>a = 0</m>.
    </p>  

    <xi:include href="./activities/act-8a-1-2.xml" />

    <p>
      Like in the quadratic case, we’ll call the cubic polynomial <m>T(x)</m> <q>degree 3 Taylor polynomial of <m>f</m> centered at <m>a=0</m></q>.
    </p>

  </subsection>

  <subsection>
    <title>As the degree of the approximation increases</title>
    <p>
      Our work so far suggests that, given the function <m>f(x)=e^x</m>, each time we increase the degree <m>n</m> of a polynomial approximation, <m>T</m>, that satisfies 
      <me>T(0) = f(0), T’(0) = f’(0), T’’(0) = f’’(0), \ldots, T^{(n)}(0) = f^{(n)}(0),</me>
      the accuracy of the approximation improves.  This leads us to investigate further what happens when we increase the degree of the approximation.
    </p>


    <p>
      So far, we have found the following approximations for <m>f(x) = e^x</m> near <m>a = 0</m>:
      <ul>
        <li>
          <p>
            <m>L(x) = 1 + x</m>
          </p>
        </li>
        <li>
          <p>
            <m>Q(x) = 1 + x + \frac{1}{2}x^2</m>
          </p>
        </li>
        <li>
          <p>
            <m>T(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3</m>
          </p>
        </li>
        <li>
          <p>
            <m>S(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3 + \frac{1}{24}x^4</m>
          </p>
        </li>
      </ul>
      In <xref ref="sec-8a-2-taylor-poly">Section</xref>, we will develop a general approach to finding the coefficient of <m>x^n</m> in the degree <m>n</m> approximation; for now, we will use the <m>4</m> functions above and study how the accuracy of the approximation changes with its degree.
    </p>

    <xi:include href="./activities/act-8a-1-3.xml" />

  </subsection>

  <subsection>
    <title>Summary</title>
    <p>
      <ul>
      <li>
        <p>
          For the function <m>f(x) = e^x</m>, which bends considerably (especially for <m>x > 0</m>) as we move away from <m>a = 0</m>, the tangent line is not a very good approximation for <m>x</m>-values that satisfy <m>|x| > 0.5</m>.  For example, <m>|f(0.5) - e^{0.5}| = 0.148721</m>, so the linear approximation has an absolute error of more than <m>0.1</m> at <m>x = 0.5</m>.
        </p>
      </li>
      <li>
        <p>
          Using the strategy of finding a higher degree polynomial whose function and derivative values match at the selected point of tangency, we appear to be able to find higher degree polynomials that approximate <m>f(x) = e^x</m> near <m>a = 0</m> much more effectively than the approximation generated by the tangent line.  For example, using the degree <m>3</m> approximation <m>T(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3</m>, we see that <m>|f(x) - T(x)| \lt 0.01</m> for all <m>x</m> that satisfy <m>|x| \lt 0.6</m>.
        </p>
      </li>
      <li>
        <p>
          It appears that the degree of the polynomial impacts the accuracy of the approximation of <m>f(x) = e^x</m> in at least two ways:  if we fix an <m>x</m>-value, the higher the degree of the polynomial, the more accurate the approximation.  In addition, raising the degree of the polynomial approximation appears to widen the interval on which the approximation is effective.
        </p>
      </li>

      </ul>
    </p>
  </subsection>


  <xi:include href="./exercises/ez-8a-1.xml" />


</section>

