<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2022                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-8a-4-taylor-series">
  <title>Taylor Series</title>
  <objectives>
    <ul>
      <li>
        <p>
          Can we 
        </p>
      </li>
    </ul>

  </objectives>

  <introduction>
    <p>
      In <xref ref="act-8a-3-3">Activity</xref>, we investigated several Taylor polynomials centered at <m>0</m> for the function <m>f(x) = \frac{1}{1-x}</m> and found that 
      <me>
        T_n(x) = 1 + x + x^2 + x^3 + \cdots + x^n
      </me>.
      Moreover, we saw that it is natural to extend the degree <m>n</m> Taylor polynomial to an infinite Taylor <em>series</em><fn>We formally define the Taylor series of a function <m>f</m> in <xref ref="D-8a-4-Taylor-series">Definition</xref>.</fn>; for <m>f(x) = \frac{1}{1-x}</m>, the corresponding Taylor series is
      <me>
        T(x) = 1 + x + x^2 + x^3 + \cdots x^n + \cdots
      </me>.
      Because <m>T(x)</m> is an infinite geometric series with <m>a = 1</m> and <m>r = x</m>, whenever <m>|r| = |x| \lt 1</m>, the series converges and its sum is
      <men xml:id="Eq-8a-4-f-equals-Tf">
        T(x) = 1 + x + x^2 + x^3 + \cdots x^n + \cdots = \frac{a}{1-r} = \frac{1}{1-x} = f(x)
      </men>.
      Remarkably, this shows that the original function, <m>f(x) = \frac{1}{1-x}</m>, is <em>equal to its Taylor series</em> for all values of <m>x</m> that satisfy <m>|x| \lt 1</m>.  So, not only do Taylor polynomials provide increasingly better approximations to a function as the degree <m>n</m> increases, but it appears that if we let <m>n</m> increase without bound we arrive at a new representation of the original function through its Taylor series<fn>This new representation may only be valid for a limited set of <m>x</m>-values, such as <m>|x| \lt 1</m> in the case of <m>f(x) = \frac{1}{1-x}</m></fn>.
    </p>

    <p>
      In <xref ref="PA-8a-4">Preview Activity</xref>, we consider an infinite geometric series and explore the function to which the series is related and that function's Taylor polynomials. 
    </p>

    <xi:include href="./previews/PA-8a-4.xml" /> 

  </introduction>  

  <subsection>
    <title>Taylor series</title>
    <p>
      From our work in <xref ref="act-8a-3-3">Activity</xref> and <xref ref="PA-8a-4">Preview Activity</xref>, we have seen two examples where the Taylor polynomials of a given function lead to a corresponding infinite Taylor series that is actually equal to the original function itself.  This suggests that Taylor series are important as they can give rise to a polynomial-like representation of a non-polynomial function.  We are now ready to formally define the Taylor series of a function.
    </p>

    <definition xml:id="D-8a-4-Taylor-series">
      <!-- <idx><h>Taylor series</h></idx> -->
      <statement>
        <p>
          Let <m>f</m> be a function such that <m>f^{(n)}(a)</m> exists for every natural number <m>n</m>.
          The <term>Taylor series for <m>f</m> centered at <m>x=a</m></term> is the series <m>T_f(x)</m> defined by
          <md>
            <mrow>T_f(x) =\mathstrut \amp \sum_{k=0}^{\infty} \frac{f^{(k)}(a)}{k!}(x-a)^k</mrow> 
            <mrow>=\mathstrut \amp f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \cdots + \frac{f^{(n)}(a)}{n!}(x-a)^n + \cdots</mrow> 
          </md>.
        </p>
      </statement>
    </definition>  

      <p>
        In the special case where <m>a=0</m> in <xref ref="D-8a-4-Taylor-series">Definition</xref>,
        the Taylor series is also sometimes called the
        <term>Maclaurin series</term>
           <!-- <idx><h>Maclaurin series</h></idx> -->
        for <m>f</m>.
      </p>

      <p>
        From <xref ref="act-8a-3-3">Activity</xref>
        we know the <m>n</m>th order Taylor polynomial centered at <m>0</m> for the function <m>f(x) = \frac{1}{1-x}</m> is
        <me>
          T_n(x) = 1 + x + x^2 + \cdots + x^n
        </me>,
        and thus the Maclaurin series for <m>f(x) = \frac{1}{1-x}</m> is
        <me>
          T_f(x) = \sum_{k=0}^{\infty} x^k
        </me>.
        As we noted earlier in <xref ref="Eq-8a-4-f-equals-Tf">Equation</xref>, because this particular series is geometric (with common ratio <m>r = x</m>), we are able to easily find a shortcut formula for its sum and understand the values of <m>x</m> for which the infinite sum makes sense.  In particular, for <m>|x| \lt 1</m>, 
        <me>
          T_f(x) = \sum_{k=0}^{\infty} x^k = \frac{1}{1-x} 
        </me>,
        which is equal to the original function <m>f(x)</m> itself.
      </p>
      <p>  
        It turns out that while most Taylor series are not geometric series, we can compare any Taylor series to a geometric series in order to determine an interval of <m>x</m>-values for which the Taylor series converges.  To see how we approach this issue, we consider the following example.
      </p>
  
    <example xml:id="Ex-8a-4-ln">
      <title>Investigating the Taylor series for <m>\ln(1+x)</m></title>
      <statement>
        <p>
          State the Taylor series at <m>a = 0</m> for <m>\ln(1+x)</m>, determine whether or not the Taylor series is geometric, and investigate the <m>x</m>-values for which the series appears to converge.
        </p>
      </statement>
      <solution>
        <p>
          In <xref ref="Ex-8a-2-Taylor-example">Example</xref>, we found that the general degree <m>n</m> Taylor polynomial centered at <m>a = 0</m> for <m>f(x) = \ln(1+x)</m> is
          <me>
            T_n(x) = x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \cdots + (-1)^{n-1}\frac{1}{n}x^n
          </me>.
          This pattern thus allows us to see that the Taylor series for <m>f(x)</m>, centered at <m>a = 0</m>, is
          <md>
            <mrow>T_f(x) =\mathstrut \amp \sum_{k=1}^{\infty} (-1)^{k-1}\frac{1}{k}x^k</mrow>
            <mrow> =\mathstrut \amp x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \cdots + (-1)^{n-1}\frac{1}{n}x^n + \cdots</mrow>
          </md>.
          Next, we determine whether or not this Taylor series is a geometric series.
        </p>

        <p>
          For a series to be geometric, it must have a constant ratio between the terms.  In <m>T_f(x)</m>, the general <m>n</m>th term is 
          <me>
            a_n(x) = (-1)^{n-1}\frac{1}{n}x^n 
          </me>
          so the <m>(n+1)</m>st term is
          <me>
            a_{n+1}(x) = (-1)^{n}\frac{1}{n+1}x^{n+1} 
          </me>.
          If we consider the ratio of these consecutive terms and call that quantity <m>r_n(x)</m>, we find that
          <me>
            r_n(x) = \frac{a_{n+1}(x)}{a_n(x)} = \frac{(-1)^{n}\frac{1}{n+1}x^{n+1}}{(-1)^{n-1}\frac{1}{n}x^n}
          </me>.
          We can rewrite this fraction algebraically and simplify it considerably.  Grouping the similar terms between the numerator and denominator, we see
          <me>
            r_n(x) = \frac{(-1)^{n}}{(-1)^{n-1}} \cdot \frac{n}{n+1} \cdot \frac{x^{n+1}}{x^n}
          </me>,
          which allows us to simplify and conclude that
          <me>
            r_n(x) = (-1) \cdot \frac{n}{n+1} \cdot x
          </me>.
          This tells us the series <m>T_f(x)</m> is not geometric since the ratio of consecutive terms depends on <m>n</m>.  For example, if we take <m>n = 2</m>, we have 
          <me>
            r_2(x) = -\frac{2}{3}x
          </me>,
          which is the ratio between the third and second terms of <m>T_f(x)</m>, while
          <me>
            r_3(x) = -\frac{3}{4}x
          </me>
          is the ratio between the fourth and third terms.  Since the ratio <m>r_n(x)</m> depends on <m>n</m>, the series lacks a common ratio between terms.
        </p>

        <p>
          However, as <m>n</m> gets large, the series <m>T_f(x)</m> is <em>almost</em> geometric.  This is because the quantity <m>\frac{n}{n+1}</m> approaches <m>1</m> as <m>n</m> increases without bound, and therefore for large <m>n</m>, 
          <me>
            r_n(x) \approx -x
          </me>.
          This suggests that the series <m>T_f(x)</m> converges for <m>|r_n(x)| \approx |-x| = |x| \lt 1</m>, since the series is very close to being geometric with a common ratio <m>-x</m>.  Graphical evidence supports the conclusion that for <m>|x| \lt 1</m>, the series <m>T_f(x)</m> converges in the same way that a geometric one would, and also that the interval of convervence is <m>-1 \lt x \lt 1</m>.  In <xref ref="F-8a-4-ln-10-20">Figure</xref>, we plot <m>f(x) = \ln(1+x)</m>, <m>T_{10}(x) = x - \frac{1}{2}x^2 + \cdots - \frac{1}{10}x^{10}</m>, and <m>T_{20}(x) = x - \frac{1}{2}x^2 + \cdots - \frac{1}{20}x^{20}</m>.
        </p>

        <figure xml:id="F-8a-4-ln-10-20">
            <caption>The function <m>f(x)=\ln(1+x)</m> and its degree <m>10</m> and <m>20</m> Taylor approximations  <m>T_{10}(x)</m> and <m>T_{20}(x)</m> near the point <m>(0,f(0))</m>.</caption>
          <image width="50%" source="images/8a_4_Ex_1" />
        </figure>

        <p>
          In <xref ref="F-8a-4-ln-10-20">Figure</xref> we see that on the interval <m>-0.8 \lt x \lt 0.8</m>, <m>f(x)</m>, <m>T_{10}(x)</m>, and <m>T_{20}(x)</m> are nearly indistinguishable.  Furthermore, we see that if we widen the interval to <m>-0.9 \lt x \lt 0.9</m>, <m>T_{20}(x)</m> remains a very good approximation of <m>f(x)</m>.  For example, we can do some computations and find that
          <me>
            f(-0.8) - T_{10}(-0.8) \approx -0.030563, f(-0.8) - T_{20}(-0.8) \approx -0.001091
          </me>,
          and
          <me>
            f(-0.9) - T_{10}(-0.9) \approx -0.183837, f(-0.8) - T_{20}(-0.8) \approx -0.032564 
          </me>.
          Increasing the degree of the approximation further allows us to do a bit better, but since <m>f(x) = \ln(1+x)</m> is undefined with a vertical asymptote at <m>x = -1</m>, no polynomial function can accurately approximate <m>f(x)</m> at <m>x = -1</m>.  Thus, it appears to be the case that <m>T_f(x)</m> converges for <m>x</m>-values that satisfy <m>-1 \lt x \lt 1</m>, and on that interval the Taylor series converges to <m>f(x) = \ln(1+x)</m>.
        </p>
      </solution>
    </example>

    <p>
      From <xref ref="Ex-8a-4-ln">Example</xref>, we see a striking result:  it appears that for <m>x</m>-values where the Taylor series <m>T_f(x)</m> of <m>f(x) = \ln(1+x)</m> converges to a finite value, the Taylor series actually equals the function <m>f</m>.  Said differently, it appears that
      <me>
        \ln(1+x) = x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \cdots + (-1)^{n-1}\frac{1}{n}x^n + \cdots
      </me>
      for <m>x</m>-values that satisfy <m>-1 \lt x \lt 1</m>.  This result is analogous to <xref ref="Eq-8a-4-f-equals-Tf">Equation</xref>, but is different in the sense that the Taylor series for <m>\ln(1+x)</m> is not geometric.  We next introduce a more formal way to test <q>how geometric</q> a Taylor series is in an effort to understand where the Taylor series is guaranteed to converge.
    </p>

    <assemblage>
    <title>The Ratio Test</title>
      <p>
        Consider an infinite series of the form <m>T(x) = \sum_{k=0}^{\infty} c_k (x-a)^k</m>, where <m>a</m> is any real number.  Let <m>r_n(x) = \frac{c_{n+1} (x-a)^{n+1}}{c_n (x-a)^n}</m> and 
        <me>
          r(x) = \lim_{n \to \infty} r_n(x) = \lim_{n \to \infty} \frac{c_{n+1} (x-a)^{n+1}}{c_n (x-a)^n}
        </me>.
        Then,
        <ul>
          <li>
            <p>
              for any real number <m>x</m> such that <m>|r(x)| \lt 1</m>, the series <m>T(x)</m> converges;
            </p>  
          </li>
          <li>
            <p>
              for any real number <m>x</m> such that <m>|r(x)| \gt 1</m>, the series <m>T(x)</m> does not converge;
            </p>
          </li>
          <li>
            <p>
              and for any <m>x</m> such that <m>|r(x)| = 1</m>, the series <m>T(x)</m> may or may not converge.
            </p>
          </li>
        </ul>
      </p>
    </assemblage>

    <p>
      In essence, the Ratio Test is a way to find <m>x</m> values for which <m>T(x)</m> behaves like a geometric series with ratio <m>r(x)</m> such that <m>|r(x)| \lt 1</m>; for those <m>x</m>-values, the infinite series converges to a finite value<fn>It is possible that the series <m>T(x)</m> also converges when <m>|r(x)| = 1</m>, but in what remains in <xref ref="C-8a">Chapter</xref>, we will not concern ourselves with this minor issue.</fn>.
    </p>

    <p>
      In light of the formal statement of the Ratio Test, we now see that in <xref ref="Ex-8a-4-ln">Example</xref>, we applied the Ratio Test to find an interval of <m>x</m>-values for which the Taylor series of <m>f(x) = \ln(1+x)</m> converges.  In particular, for 
      <me>
        T_f(x) = \sum_{k=1}^{\infty} (-1)^{k-1}\frac{1}{k}x^k
      </me>
      we found that 
      <me>
        r_n(x) = \frac{(-1)^{n}\frac{1}{n+1}x^{n+1}}{(-1)^{n-1}\frac{1}{n}x^n} = (-1) \cdot \frac{n}{n+1} \cdot x
      </me>
      and therefore
      <me>
        r(x) = \lim_{n \to \infty} r_n(x) = \lim_{n \to \infty} (-1) \cdot \frac{n}{n+1} \cdot x = -x
      </me>.
      By the Ratio Test, it follows that if <m>|r(x)| = |-x| = x \lt 1</m>, then the series converges, and if <m>|r(x)| = x \gt 1</m>, the series does not converge.  When <m>x = \pm 1</m>, we don't know if the series converges or diverges, but we will normally not be concerned with this <q>endpoint behavior</q>.
    </p>

    <xi:include href="./activities/act-8a-4-1.xml" />

  </subsection>

  <subsection>
    <title>
      Taylor series of several important functions
    </title>

    <p>
      So far, we have established that the Taylor series of two important functions, <m>\frac{1}{1-x}</m> and <m>\ln(1+x)</m>, converge on an interval of <m>x</m>-values and on that interval converge to the respective functions.  In particular,
      <ul>
        <li>
          <p>
            If <m>|x| \lt 1</m>, then <m>\frac{1}{1-x} = \sum_{k=0}^{\infty} x^k = 1 + x + x^2 + x^3 + \cdots</m>;
          </p>
        </li>
        <li>
          <p>
            If <m>|x| \lt 1</m>, then <m>\ln(1+x) = \sum_{k=1}^{\infty} (-1)^{n-1} \cdot \frac{1}{n} \cdot x^n =  x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \cdots</m>.
          </p>
        </li>
      </ul>
      Three other important functions <dash> <m>\sin(x)</m>, <m>\cos(x)</m>, and <m>e^x</m> </dash> that we have studied turn out to have similar representations, and so we build on our work with their respective Taylor polynomials in <xref ref="sec-8a-1-linear-poly">Section</xref> and <xref ref="sec-8a-2-taylor-poly">Section</xref> in order to investigate and understand their Taylor series.
    </p>

<!--    <xi:include href="./activities/act-8a-4-2.xml" /> -->

<!--    <xi:include href="./activities/act-8a-4-3.xml" /> -->

  </subsection>

  <subsection>
    <title>Summary</title>
    <p>
    <ul>
      <li>
        <p>
          Provided 
        </p>
      </li>
    </ul>
    </p>
  </subsection>

<!--  <xi:include href="./exercises/ez-8a-4.xml" /> -->

</section>